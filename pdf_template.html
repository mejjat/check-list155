<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Checklist Moteur Thermique - {{ checklist.numero_serie_moteur }}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 20px;
        }
        .section-title {
            background-color: #f0f0f0;
            padding: 5px;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
        }
        .status-cell {
            text-align: center;
            font-weight: bold;
        }
        .status-na, .status-manquant {
            background-color: #ffcccc;
            color: #cc0000;
        }
        .status-neuf {
            background-color: #ccffcc;
            color: #006600;
        }
        .status-bon {
            background-color: #cce5ff;
            color: #004085;
        }
        .status-mauvais {
            background-color: #ffe6cc;
            color: #cc3300;
        }
        .print-date {
            text-align: right;
            margin: 10px 0;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Checklist Moteur Thermique</h1>
        <h2>{{ checklist.type_checklist }}</h2>
        <div class="print-date">
            Date d'impression: {{ current_time.strftime('%d-%m-%Y à %H:%M') }}
        </div>
    </div>

    <div class="section">
        <h3 class="section-title">Informations Générales</h3>
        <table>
            <tr>
                <th>Date de contrôle</th>
                <td>{{ checklist.date_controle.strftime('%d-%m-%Y') }}</td>
                <th>Type de révision</th>
                <td>{{ checklist.type_revision }}</td>
            </tr>
            <tr>
                <th>Responsable électrique</th>
                <td>{{ checklist.responsable_electrique }}</td>
                <th>Responsable atelier</th>
                <td>{{ checklist.responsable_atelier }}</td>
            </tr>
            <tr>
                <th>Inspecteur méthode</th>
                <td>{{ checklist.inspecteur_methode }}</td>
                <th>HM actuel</th>
                <td>{{ checklist.hm_actuel }}</td>
            </tr>
            <tr>
                <th>Catégorie engin</th>
                <td>{{ checklist.categorie_engin }}</td>
                <th>N° Série moteur</th>
                <td>{{ checklist.numero_serie_moteur }}</td>
            </tr>
            <tr>
                <th>N° Série ECM</th>
                <td colspan="3">{{ checklist.numero_serie_ecm }}</td>
            </tr>
            <tr>
                <th>Statut</th>
                <td colspan="3" class="status-cell status-{{ checklist.status.lower() }}">{{ checklist.status.upper() }}</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h3 class="section-title">Contrôle des Capteurs</h3>
        <table>
            <tr>
                <th style="width: 40%">Capteur</th>
                <th style="width: 10%">État</th>
                <th style="width: 40%">Capteur</th>
                <th style="width: 10%">État</th>
            </tr>
            <tr>
                <td>Régime moteur</td>
                <td class="status-{{ checklist.capteur_regime_moteur.lower() }}">{{ checklist.capteur_regime_moteur }}</td>
                <td>Température liquide</td>
                <td class="status-{{ checklist.capteur_temp_liquide.lower() }}">{{ checklist.capteur_temp_liquide }}</td>
            </tr>
            <tr>
                <td>Switch température eau</td>
                <td class="status-{{ checklist.switch_temp_eau.lower() }}">{{ checklist.switch_temp_eau }}</td>
                <td>Palpeur débit liquide</td>
                <td class="status-{{ checklist.palpeur_debit_liquide.lower() }}">{{ checklist.palpeur_debit_liquide }}</td>
            </tr>
            <tr>
                <td>Capteur pression huile</td>
                <td class="status-{{ checklist.capteur_pression_huile.lower() }}">{{ checklist.capteur_pression_huile }}</td>
                <td>Capteur niveau huile</td>
                <td class="status-{{ checklist.capteur_niveau_huile.lower() }}">{{ checklist.capteur_niveau_huile }}</td>
            </tr>
            <tr>
                <td>Capteur pression admission</td>
                <td class="status-{{ checklist.capteur_pression_admission.lower() }}">{{ checklist.capteur_pression_admission }}</td>
                <td>Capteur température admission</td>
                <td class="status-{{ checklist.capteur_temp_admission.lower() }}">{{ checklist.capteur_temp_admission }}</td>
            </tr>
            <tr>
                <td>Capteur température échappement droit</td>
                <td class="status-{{ checklist.capteur_temp_echap_droit.lower() }}">{{ checklist.capteur_temp_echap_droit }}</td>
                <td>Capteur température échappement gauche</td>
                <td class="status-{{ checklist.capteur_temp_echap_gauche.lower() }}">{{ checklist.capteur_temp_echap_gauche }}</td>
            </tr>
            <tr>
                <td>Capteur température air ambiant</td>
                <td class="status-{{ checklist.capteur_temp_air_ambiant.lower() }}">{{ checklist.capteur_temp_air_ambiant }}</td>
                <td>Capteur pression gasoil</td>
                <td class="status-{{ checklist.capteur_pression_gasoil.lower() }}">{{ checklist.capteur_pression_gasoil }}</td>
            </tr>
            <tr>
                <td>Switch pression gasoil</td>
                <td class="status-{{ checklist.switch_pression_gasoil.lower() }}">{{ checklist.switch_pression_gasoil }}</td>
                <td>Capteur pression carter</td>
                <td class="status-{{ checklist.capteur_pression_carter.lower() }}">{{ checklist.capteur_pression_carter }}</td>
            </tr>
            <tr>
                <td>Switch pression huile</td>
                <td class="status-{{ checklist.switch_pression_huile.lower() }}">{{ checklist.switch_pression_huile }}</td>
                <td>Capteur régime primaire</td>
                <td class="status-{{ checklist.capteur_regime_primaire.lower() }}">{{ checklist.capteur_regime_primaire }}</td>
            </tr>
            <tr>
                <td>Capteur régime secondaire</td>
                <td class="status-{{ checklist.capteur_regime_secondaire.lower() }}">{{ checklist.capteur_regime_secondaire }}</td>
                <td>Capteur vitesse convertisseur</td>
                <td class="status-{{ checklist.capteur_vitesse_convertisseur.lower() }}">{{ checklist.capteur_vitesse_convertisseur }}</td>
            </tr>
            <tr>
                <td>Capteur température convertisseur</td>
                <td class="status-{{ checklist.capteur_temp_convertisseur.lower() }}">{{ checklist.capteur_temp_convertisseur }}</td>
                <td>Capteur pression atmosphérique</td>
                <td class="status-{{ checklist.capteur_pression_atmo.lower() }}">{{ checklist.capteur_pression_atmo }}</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h3 class="section-title">Circuit de Démarrage</h3>
        <table>
            <tr>
                <th style="width: 40%">Composant</th>
                <th style="width: 10%">État</th>
                <th style="width: 40%">Composant</th>
                <th style="width: 10%">État</th>
            </tr>
            <tr>
                <td>Démarreur 1</td>
                <td class="status-{{ checklist.demarreur_1.lower() }}">{{ checklist.demarreur_1 }}</td>
                <td>Démarreur 2</td>
                <td class="status-{{ checklist.demarreur_2.lower() }}">{{ checklist.demarreur_2 }}</td>
            </tr>
            <tr>
                <td>Alternateur charge</td>
                <td class="status-{{ checklist.alternateur_charge.lower() }}">{{ checklist.alternateur_charge }}</td>
                <td>Courroie alternateur</td>
                <td class="status-{{ checklist.courroie_alternateur.lower() }}">{{ checklist.courroie_alternateur }}</td>
            </tr>
            <tr>
                <td>Tendeur courroie</td>
                <td class="status-{{ checklist.tendeur_courroie.lower() }}">{{ checklist.tendeur_courroie }}</td>
                <td>État tension courroie</td>
                <td class="status-{{ checklist.etat_tension_courroie.lower() }}">{{ checklist.etat_tension_courroie }}</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h3 class="section-title">Contrôle Branchement et Câblage</h3>
        <table>
            <tr>
                <th style="width: 70%">Élément</th>
                <th style="width: 30%">État</th>
            </tr>
            <tr>
                <td>Faisceau électrique</td>
                <td class="status-{{ checklist.faisceau_electrique.lower() }}">{{ checklist.faisceau_electrique }}</td>
            </tr>
            <tr>
                <td>Branchement électrique</td>
                <td class="status-{{ checklist.branchement_electrique.lower() }}">{{ checklist.branchement_electrique }}</td>
            </tr>
            <tr>
                <td>Attachement et isolation</td>
                <td class="status-{{ checklist.attachement_isolation.lower() }}">{{ checklist.attachement_isolation }}</td>
            </tr>
        </table>
    </div>
</body>
</html>
